{
  "version": 4,
  "terraform_version": "1.0.9",
  "serial": 217,
  "lineage": "1b860d41-c8d0-766f-aecf-2ef92e2f7b88",
  "outputs": {
    "db_server_ips": {
      "value": {
        "db-server": "116.203.179.134"
      },
      "type": [
        "object",
        {
          "db-server": "string"
        }
      ]
    },
    "db_server_status": {
      "value": {
        "db-server": "running"
      },
      "type": [
        "object",
        {
          "db-server": "string"
        }
      ]
    },
    "workers_servers_ips": {
      "value": {
        "worker-0": "116.203.218.217"
      },
      "type": [
        "object",
        {
          "worker-0": "string"
        }
      ]
    },
    "workers_servers_status": {
      "value": {
        "worker-0": "running"
      },
      "type": [
        "object",
        {
          "worker-0": "string"
        }
      ]
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "template_file",
      "name": "user_data",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "facbaf895f030cce813e9fd98e7fca0ae5846f6dafaa83f458dc66ede1ca4b33",
            "rendered": "#cloud-config\nusers:\n  - name: devops\n    groups: users, admin\n    sudo: ALL=(ALL) NOPASSWD:ALL\n    shell: /bin/bash\n    ssh_authorized_keys:\n      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7E75JwR78Zj0AGf0Hk9VqAs9e37+yOPNNssEdbHM3Uh15BvoHqDTfr8zRO3OsiWBeFmIR0KH8qdwraj1DGGsvnDAwDbi1mQH6V4e/9U269oBFJWKiLAxLUStyRGwK2EZOJvKjT6coic0Hck6I+LUp8QQRMZT8B4UJVk6N4nq0bg0v23dGUm6ULfrMHdJlLGde8Eb+ln/CWjOQXP/4G2UAOGi5PLlftqqJnqsGDS+MfCmNofifjq6NnF65i9JWkrfEVye3Ny3jwEEkBOaojtv9atjE+ExCsmH2BbJYAjEKNjamQwJkJ4iteGZEm88JCOkzRDr0ZEbgac4l7snbRTWt+2rz0UFnzYj00iAnrvQRh1OGgopspSZr7VJEvqdajO24PB7EuNVhG/y4mCpQ7ui1zFLF7X8s1/l6BXuCquiMOtldas5WzgAi1BiyOY3dj6iSEiR182asOsv/VRmmoQGIWQWU1qDQ7fvNCr+qKqSllslkJDb1MMgUumRiCKUI2VrdHt2tKuoHIKxR3zrHAhRe7gDCokPACFUcqOwL6wgFhtqtKJ1EzVl8yQBngnmaPDH/VGUHFhWU6i13hW76B1I/hhdI670l0YyJlsscxpBzWtHlgqTRzNX0l9LpWZhBXkKMluAH0JVy1fOfOs/zHJwqEkCmdDQyuuzN0z/B4PCCGQ== renanssilva@MacBook-Pro.local\npackage_update: true\npackage_upgrade: true\npackages:\n  - git\n  - vim\n  - neovim\n  - gcc\n  - make\n  - cmake - libsdl2-dev\n  - libsdl2-ttf-dev\nruncmd:\n  - cd /home/devops\n  - touch I_WAS_HERE\n  - echo \"sudo tail -f -n25 /var/log/cloud-init-output.log\" \u003e ./tail_log.sh\n  - echo \"sudo less /var/log/cloud-init-output.log\" \u003e ./less_log.sh\n  - su devops -c \"echo 'PATH=/home/devops/.local/bin:$PATH' \u003e\u003e ~/.bashrc\"\n  - su devops -c \"echo 'PATH=/home/devops/.poetry/bin:$PATH' \u003e\u003e ~/.bashrc\"\n\n    # Python 3.10 setup\n  - apt install software-properties-common -y\n  - add-apt-repository ppa:deadsnakes/ppa -y\n  - apt update\n  - apt install python3.10-full -y\n  - su devops -c \"python3.10 -m ensurepip --upgrade\"\n  - su devops -c \"python3.10 -m pip install --upgrade pip\"\n\n    # Get gabate\n  - git clone 'https://github.com/h3nnn4n/gabate'\n  - chown -R devops:devops gabate\n  - cd gabate\n\n    ## Gabate deps\n  - git submodule update --init --recursive\n  - cd deps/pcg-c/ \u0026\u0026 make -j 4 \u0026\u0026 cd -\n  - cd deps/cJSON/ \u0026\u0026 mkdir build \u0026\u0026 cd build \u0026\u0026 cmake .. \u0026\u0026 make -j 4 \u0026\u0026 cd ../../../\n\n    ## Build gabate\n  - make -j 4\n\n    # Worker setup\n  - cd worker\n\n    # Instal poetry and worker deps\n  - su devops -c \"curl -sSL https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py | python3.10 - \"\n  - su devops -l -c \"cd /home/devops/gabate/worker/ \u0026\u0026 /home/devops/.poetry/bin/poetry install\"\n\n    # Run celery\n  - su devops -l -c \"cd /home/devops/gabate/worker/ \u0026\u0026 /home/devops/.poetry/bin/poetry run celery -A tasks worker --loglevel=INFO --detach -f celery.logs\"\n",
            "template": "#cloud-config\nusers:\n  - name: devops\n    groups: users, admin\n    sudo: ALL=(ALL) NOPASSWD:ALL\n    shell: /bin/bash\n    ssh_authorized_keys:\n      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7E75JwR78Zj0AGf0Hk9VqAs9e37+yOPNNssEdbHM3Uh15BvoHqDTfr8zRO3OsiWBeFmIR0KH8qdwraj1DGGsvnDAwDbi1mQH6V4e/9U269oBFJWKiLAxLUStyRGwK2EZOJvKjT6coic0Hck6I+LUp8QQRMZT8B4UJVk6N4nq0bg0v23dGUm6ULfrMHdJlLGde8Eb+ln/CWjOQXP/4G2UAOGi5PLlftqqJnqsGDS+MfCmNofifjq6NnF65i9JWkrfEVye3Ny3jwEEkBOaojtv9atjE+ExCsmH2BbJYAjEKNjamQwJkJ4iteGZEm88JCOkzRDr0ZEbgac4l7snbRTWt+2rz0UFnzYj00iAnrvQRh1OGgopspSZr7VJEvqdajO24PB7EuNVhG/y4mCpQ7ui1zFLF7X8s1/l6BXuCquiMOtldas5WzgAi1BiyOY3dj6iSEiR182asOsv/VRmmoQGIWQWU1qDQ7fvNCr+qKqSllslkJDb1MMgUumRiCKUI2VrdHt2tKuoHIKxR3zrHAhRe7gDCokPACFUcqOwL6wgFhtqtKJ1EzVl8yQBngnmaPDH/VGUHFhWU6i13hW76B1I/hhdI670l0YyJlsscxpBzWtHlgqTRzNX0l9LpWZhBXkKMluAH0JVy1fOfOs/zHJwqEkCmdDQyuuzN0z/B4PCCGQ== renanssilva@MacBook-Pro.local\npackage_update: true\npackage_upgrade: true\npackages:\n  - git\n  - vim\n  - neovim\n  - gcc\n  - make\n  - cmake - libsdl2-dev\n  - libsdl2-ttf-dev\nruncmd:\n  - cd /home/devops\n  - touch I_WAS_HERE\n  - echo \"sudo tail -f -n25 /var/log/cloud-init-output.log\" \u003e ./tail_log.sh\n  - echo \"sudo less /var/log/cloud-init-output.log\" \u003e ./less_log.sh\n  - su devops -c \"echo 'PATH=/home/devops/.local/bin:$PATH' \u003e\u003e ~/.bashrc\"\n  - su devops -c \"echo 'PATH=/home/devops/.poetry/bin:$PATH' \u003e\u003e ~/.bashrc\"\n\n    # Python 3.10 setup\n  - apt install software-properties-common -y\n  - add-apt-repository ppa:deadsnakes/ppa -y\n  - apt update\n  - apt install python3.10-full -y\n  - su devops -c \"python3.10 -m ensurepip --upgrade\"\n  - su devops -c \"python3.10 -m pip install --upgrade pip\"\n\n    # Get gabate\n  - git clone 'https://github.com/h3nnn4n/gabate'\n  - chown -R devops:devops gabate\n  - cd gabate\n\n    ## Gabate deps\n  - git submodule update --init --recursive\n  - cd deps/pcg-c/ \u0026\u0026 make -j 4 \u0026\u0026 cd -\n  - cd deps/cJSON/ \u0026\u0026 mkdir build \u0026\u0026 cd build \u0026\u0026 cmake .. \u0026\u0026 make -j 4 \u0026\u0026 cd ../../../\n\n    ## Build gabate\n  - make -j 4\n\n    # Worker setup\n  - cd worker\n\n    # Instal poetry and worker deps\n  - su devops -c \"curl -sSL https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py | python3.10 - \"\n  - su devops -l -c \"cd /home/devops/gabate/worker/ \u0026\u0026 /home/devops/.poetry/bin/poetry install\"\n\n    # Run celery\n  - su devops -l -c \"cd /home/devops/gabate/worker/ \u0026\u0026 /home/devops/.poetry/bin/poetry run celery -A tasks worker --loglevel=INFO --detach -f celery.logs\"\n",
            "vars": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "template_file",
      "name": "user_data_db",
      "provider": "provider[\"registry.terraform.io/hashicorp/template\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "filename": null,
            "id": "f764163eb8a6ca9fd2200da787d0842c4100404a1f9f79ebc9ada90b0549be45",
            "rendered": "#cloud-config\nusers:\n  - name: devops\n    groups: users, admin\n    sudo: ALL=(ALL) NOPASSWD:ALL\n    shell: /bin/bash\n    ssh_authorized_keys:\n      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7E75JwR78Zj0AGf0Hk9VqAs9e37+yOPNNssEdbHM3Uh15BvoHqDTfr8zRO3OsiWBeFmIR0KH8qdwraj1DGGsvnDAwDbi1mQH6V4e/9U269oBFJWKiLAxLUStyRGwK2EZOJvKjT6coic0Hck6I+LUp8QQRMZT8B4UJVk6N4nq0bg0v23dGUm6ULfrMHdJlLGde8Eb+ln/CWjOQXP/4G2UAOGi5PLlftqqJnqsGDS+MfCmNofifjq6NnF65i9JWkrfEVye3Ny3jwEEkBOaojtv9atjE+ExCsmH2BbJYAjEKNjamQwJkJ4iteGZEm88JCOkzRDr0ZEbgac4l7snbRTWt+2rz0UFnzYj00iAnrvQRh1OGgopspSZr7VJEvqdajO24PB7EuNVhG/y4mCpQ7ui1zFLF7X8s1/l6BXuCquiMOtldas5WzgAi1BiyOY3dj6iSEiR182asOsv/VRmmoQGIWQWU1qDQ7fvNCr+qKqSllslkJDb1MMgUumRiCKUI2VrdHt2tKuoHIKxR3zrHAhRe7gDCokPACFUcqOwL6wgFhtqtKJ1EzVl8yQBngnmaPDH/VGUHFhWU6i13hW76B1I/hhdI670l0YyJlsscxpBzWtHlgqTRzNX0l9LpWZhBXkKMluAH0JVy1fOfOs/zHJwqEkCmdDQyuuzN0z/B4PCCGQ== renanssilva@MacBook-Pro.local\npackage_update: true\npackage_upgrade: true\npackages:\n  - git\n  - vim\n  - neovim\n  - gnupg\n  - redis-server\nruncmd:\n  - cd /home/devops\n  - touch $HOME/I_WAS_HERE\n\n    # mongo\n  - wget -qO - https://www.mongodb.org/static/pgp/server-5.0.asc | apt-key add -\n  - echo \"deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/5.0 multiverse\" | tee /etc/apt/sources.list.d/mongodb-org-5.0.list\n  - apt-get update\n  - apt-get install -y mongodb-org\n\n    # rabbitmq\n  - wget -O- https://packages.erlang-solutions.com/ubuntu/erlang_solutions.asc | apt-key add -\n  - echo \"deb https://packages.erlang-solutions.com/ubuntu focal contrib\" | tee /etc/apt/sources.list.d/rabbitmq.list\n  - curl -s https://packagecloud.io/install/repositories/rabbitmq/rabbitmq-server/script.deb.sh | bash\n  - apt-get update\n  - apt-get install -y rabbitmq-server --fix-missing\n  - sudo systemctl start rabbitmq-server\n  - sudo systemctl enable rabbitmq-server\n  - sudo systemctl status rabbitmq-server\n\n    # redis\n    # ¯\\_(ツ)_/¯\n",
            "template": "#cloud-config\nusers:\n  - name: devops\n    groups: users, admin\n    sudo: ALL=(ALL) NOPASSWD:ALL\n    shell: /bin/bash\n    ssh_authorized_keys:\n      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7E75JwR78Zj0AGf0Hk9VqAs9e37+yOPNNssEdbHM3Uh15BvoHqDTfr8zRO3OsiWBeFmIR0KH8qdwraj1DGGsvnDAwDbi1mQH6V4e/9U269oBFJWKiLAxLUStyRGwK2EZOJvKjT6coic0Hck6I+LUp8QQRMZT8B4UJVk6N4nq0bg0v23dGUm6ULfrMHdJlLGde8Eb+ln/CWjOQXP/4G2UAOGi5PLlftqqJnqsGDS+MfCmNofifjq6NnF65i9JWkrfEVye3Ny3jwEEkBOaojtv9atjE+ExCsmH2BbJYAjEKNjamQwJkJ4iteGZEm88JCOkzRDr0ZEbgac4l7snbRTWt+2rz0UFnzYj00iAnrvQRh1OGgopspSZr7VJEvqdajO24PB7EuNVhG/y4mCpQ7ui1zFLF7X8s1/l6BXuCquiMOtldas5WzgAi1BiyOY3dj6iSEiR182asOsv/VRmmoQGIWQWU1qDQ7fvNCr+qKqSllslkJDb1MMgUumRiCKUI2VrdHt2tKuoHIKxR3zrHAhRe7gDCokPACFUcqOwL6wgFhtqtKJ1EzVl8yQBngnmaPDH/VGUHFhWU6i13hW76B1I/hhdI670l0YyJlsscxpBzWtHlgqTRzNX0l9LpWZhBXkKMluAH0JVy1fOfOs/zHJwqEkCmdDQyuuzN0z/B4PCCGQ== renanssilva@MacBook-Pro.local\npackage_update: true\npackage_upgrade: true\npackages:\n  - git\n  - vim\n  - neovim\n  - gnupg\n  - redis-server\nruncmd:\n  - cd /home/devops\n  - touch $HOME/I_WAS_HERE\n\n    # mongo\n  - wget -qO - https://www.mongodb.org/static/pgp/server-5.0.asc | apt-key add -\n  - echo \"deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/5.0 multiverse\" | tee /etc/apt/sources.list.d/mongodb-org-5.0.list\n  - apt-get update\n  - apt-get install -y mongodb-org\n\n    # rabbitmq\n  - wget -O- https://packages.erlang-solutions.com/ubuntu/erlang_solutions.asc | apt-key add -\n  - echo \"deb https://packages.erlang-solutions.com/ubuntu focal contrib\" | tee /etc/apt/sources.list.d/rabbitmq.list\n  - curl -s https://packagecloud.io/install/repositories/rabbitmq/rabbitmq-server/script.deb.sh | bash\n  - apt-get update\n  - apt-get install -y rabbitmq-server --fix-missing\n  - sudo systemctl start rabbitmq-server\n  - sudo systemctl enable rabbitmq-server\n  - sudo systemctl status rabbitmq-server\n\n    # redis\n    # ¯\\_(ツ)_/¯\n",
            "vars": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "hcloud_server",
      "name": "db_server",
      "provider": "provider[\"registry.terraform.io/hetznercloud/hcloud\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "backup_window": "",
            "backups": false,
            "datacenter": "nbg1-dc3",
            "delete_protection": false,
            "firewall_ids": [],
            "id": "15522835",
            "image": "ubuntu-20.04",
            "ipv4_address": "116.203.179.134",
            "ipv6_address": "2a01:4f8:1c0c:6e75::1",
            "ipv6_network": "2a01:4f8:1c0c:6e75::/64",
            "iso": null,
            "keep_disk": false,
            "labels": {
              "type": "db_server"
            },
            "location": "nbg1",
            "name": "db-server",
            "network": [],
            "placement_group_id": null,
            "rebuild_protection": false,
            "rescue": null,
            "server_type": "cx11",
            "ssh_keys": [
              "4707616"
            ],
            "status": "running",
            "timeouts": null,
            "user_data": "RXEjVjIipm7XT+zO7UBeIWbxJdc="
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo1NDAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.template_file.user_data_db",
            "hcloud_ssh_key.default"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "hcloud_server",
      "name": "worker",
      "provider": "provider[\"registry.terraform.io/hetznercloud/hcloud\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "backup_window": "",
            "backups": false,
            "datacenter": "nbg1-dc3",
            "delete_protection": false,
            "firewall_ids": [],
            "id": "15522833",
            "image": "ubuntu-20.04",
            "ipv4_address": "116.203.218.217",
            "ipv6_address": "2a01:4f8:1c1c:76eb::1",
            "ipv6_network": "2a01:4f8:1c1c:76eb::/64",
            "iso": null,
            "keep_disk": false,
            "labels": {
              "type": "workers"
            },
            "location": "nbg1",
            "name": "worker-0",
            "network": [],
            "placement_group_id": null,
            "rebuild_protection": false,
            "rescue": null,
            "server_type": "cx11",
            "ssh_keys": [
              "4707616"
            ],
            "status": "running",
            "timeouts": null,
            "user_data": "TuIT36COnPH98p9ttgp+BS9cgtg="
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo1NDAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.template_file.user_data",
            "hcloud_ssh_key.default"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "hcloud_ssh_key",
      "name": "default",
      "provider": "provider[\"registry.terraform.io/hetznercloud/hcloud\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "fingerprint": "18:8a:5b:c8:46:e8:f6:12:66:6b:00:ff:46:6f:cb:f7",
            "id": "4707616",
            "labels": null,
            "name": "hetzner_key",
            "public_key": "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQC7E75JwR78Zj0AGf0Hk9VqAs9e37+yOPNNssEdbHM3Uh15BvoHqDTfr8zRO3OsiWBeFmIR0KH8qdwraj1DGGsvnDAwDbi1mQH6V4e/9U269oBFJWKiLAxLUStyRGwK2EZOJvKjT6coic0Hck6I+LUp8QQRMZT8B4UJVk6N4nq0bg0v23dGUm6ULfrMHdJlLGde8Eb+ln/CWjOQXP/4G2UAOGi5PLlftqqJnqsGDS+MfCmNofifjq6NnF65i9JWkrfEVye3Ny3jwEEkBOaojtv9atjE+ExCsmH2BbJYAjEKNjamQwJkJ4iteGZEm88JCOkzRDr0ZEbgac4l7snbRTWt+2rz0UFnzYj00iAnrvQRh1OGgopspSZr7VJEvqdajO24PB7EuNVhG/y4mCpQ7ui1zFLF7X8s1/l6BXuCquiMOtldas5WzgAi1BiyOY3dj6iSEiR182asOsv/VRmmoQGIWQWU1qDQ7fvNCr+qKqSllslkJDb1MMgUumRiCKUI2VrdHt2tKuoHIKxR3zrHAhRe7gDCokPACFUcqOwL6wgFhtqtKJ1EzVl8yQBngnmaPDH/VGUHFhWU6i13hW76B1I/hhdI670l0YyJlsscxpBzWtHlgqTRzNX0l9LpWZhBXkKMluAH0JVy1fOfOs/zHJwqEkCmdDQyuuzN0z/B4PCCGQ== renanssilva@MacBook-Pro.local\n"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    }
  ]
}
