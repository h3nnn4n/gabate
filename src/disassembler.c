#include <stdio.h>
#include <stdlib.h>

#include "disassembler.h"

// Based from https://raw.githubusercontent.com/mehcode/wadatsumi/master/src/operation.rs
unsigned short int disassembler( unsigned char *buffer, unsigned int pc ) {
    unsigned short int op_size = 1;

    switch ( buffer[pc] ) {
        case 0x00:   printf ( " %04x : %2x              NOP                       \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x01:   printf ( " %04x : %2x %2x %2x      LD BC, 0x%02x%02x         \n", pc, buffer[pc], buffer[pc+1], buffer[pc+2] , buffer[pc+1], buffer[pc+2] ); op_size = 3; break;
        case 0x02:   printf ( " %04x : %2x              LD (BC), A                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x03:   printf ( " %04x : %2x              INC BC                    \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x04:   printf ( " %04x : %2x              INC B                     \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x05:   printf ( " %04x : %2x              DEC B                     \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x06:   printf ( " %04x : %2x %2x          LD B, 0x%02x              \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0x07:   printf ( " %04x : %2x              RLCA                      \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x08:   printf ( " %04x : %2x %2x %2x      LD (0x%02x%02x), SP       \n", pc, buffer[pc], buffer[pc+1], buffer[pc+2], buffer[pc+1], buffer[pc+2]  ); op_size = 3; break;
        case 0x09:   printf ( " %04x : %2x              ADD HL, BC                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x0A:   printf ( " %04x : %2x              LD A, (BC)                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x0B:   printf ( " %04x : %2x              DEC BC                    \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x0C:   printf ( " %04x : %2x              INC C                     \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x0D:   printf ( " %04x : %2x              DEC C                     \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x0E:   printf ( " %04x : %2x %2x          LD C, 0x%02x              \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0x0F:   printf ( " %04x : %2x              RRCA                      \n", pc, buffer[pc]                                                          ); op_size = 1; break;

        case 0x10:   printf ( " %04x : %2x              STOP                      \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x11:   printf ( " %04x : %2x %2x %2x      LD DE, 0x%02x%02x         \n", pc, buffer[pc], buffer[pc+1], buffer[pc+2], buffer[pc+1], buffer[pc+2]  ); op_size = 3; break;
        case 0x12:   printf ( " %04x : %2x              LD (DE), A                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x13:   printf ( " %04x : %2x              INC DE                    \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x14:   printf ( " %04x : %2x              INC D                     \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x15:   printf ( " %04x : %2x              DEC D                     \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x16:   printf ( " %04x : %2x %2x          LD D, 0x%02x              \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0x17:   printf ( " %04x : %2x              RLA                       \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x18:   printf ( " %04x : %2x %2x          JR 0x%02x                 \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0x19:   printf ( " %04x : %2x              ADD HL, DE                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x1A:   printf ( " %04x : %2x              LD A, (DE)                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x1B:   printf ( " %04x : %2x              DEC DE                    \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x1C:   printf ( " %04x : %2x              INC E                     \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x1D:   printf ( " %04x : %2x              DEC E                     \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x1E:   printf ( " %04x : %2x %2x          LD E, 0x%02x              \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0x1F:   printf ( " %04x : %2x              RRA                       \n", pc, buffer[pc]                                                          ); op_size = 1; break;

        case 0x20:   printf ( " %04x : %2x %2x          JR NZ, 0x%02x             \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0x21:   printf ( " %04x : %2x %2x %2x      LD HL, 0x%02x%02x         \n", pc, buffer[pc], buffer[pc+1], buffer[pc+2], buffer[pc+1], buffer[pc+2]  ); op_size = 3; break;
        case 0x22:   printf ( " %04x : %2x              LDI (HL), A               \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x23:   printf ( " %04x : %2x              INC HL                    \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x24:   printf ( " %04x : %2x              INC H                     \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x25:   printf ( " %04x : %2x              DEC H                     \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x26:   printf ( " %04x : %2x %2x          LD H, 0x%02x              \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0x27:   printf ( " %04x : %2x              DAA                       \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x28:   printf ( " %04x : %2x %2x          JR Z, 0x%02x              \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0x29:   printf ( " %04x : %2x              ADD HL, HL                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x2A:   printf ( " %04x : %2x              LDI A, (HL)               \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x2B:   printf ( " %04x : %2x              DEC HL                    \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x2C:   printf ( " %04x : %2x              INC L                     \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x2D:   printf ( " %04x : %2x              DEC L                     \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x2E:   printf ( " %04x : %2x %2x          LD L, 0x%02x              \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0x2F:   printf ( " %04x : %2x              CPL                       \n", pc, buffer[pc]                                                          ); op_size = 1; break;

        case 0x30:   printf ( " %04x : %2x %2x          JR NC, 0x%02x             \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0x31:   printf ( " %04x : %2x %2x %2x      LD SP, (0x%02x%02x)       \n", pc, buffer[pc], buffer[pc+1], buffer[pc+2], buffer[pc+1], buffer[pc+2]  ); op_size = 3; break;
        case 0x32:   printf ( " %04x : %2x              LDD (HL), A               \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x33:   printf ( " %04x : %2x              INC SP                    \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x34:   printf ( " %04x : %2x              INC (HL)                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x35:   printf ( " %04x : %2x              DEC (HL)                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x36:   printf ( " %04x : %2x %2x          LD (HL), 0x%02x           \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0x37:   printf ( " %04x : %2x              SCF                       \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x38:   printf ( " %04x : %2x %2x          JR C, 0x%02x              \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0x39:   printf ( " %04x : %2x              ADD HL, SP                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x3A:   printf ( " %04x : %2x              LDD A, (HL)               \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x3B:   printf ( " %04x : %2x              DEC SP                    \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x3C:   printf ( " %04x : %2x              INC A                     \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x3D:   printf ( " %04x : %2x              DEC A                     \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x3E:   printf ( " %04x : %2x %2x          LD A, 0x%02x              \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0x3F:   printf ( " %04x : %2x              CCF                       \n", pc, buffer[pc]                                                          ); op_size = 1; break;

        case 0x40:   printf ( " %04x : %2x              LD B, B                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x41:   printf ( " %04x : %2x              LD B, C                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x42:   printf ( " %04x : %2x              LD B, D                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x43:   printf ( " %04x : %2x              LD B, E                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x44:   printf ( " %04x : %2x              LD B, H                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x45:   printf ( " %04x : %2x              LD B, L                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x46:   printf ( " %04x : %2x              LD B, (HL)                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x47:   printf ( " %04x : %2x              LD B, A                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x48:   printf ( " %04x : %2x              LD C, B                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x49:   printf ( " %04x : %2x              LD C, C                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x4A:   printf ( " %04x : %2x              LD C, D                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x4B:   printf ( " %04x : %2x              LD C, E                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x4C:   printf ( " %04x : %2x              LD C, H                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x4D:   printf ( " %04x : %2x              LD C, L                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x4E:   printf ( " %04x : %2x              LD C, (HL)                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x4F:   printf ( " %04x : %2x              LD C, A                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;

        case 0x50:   printf ( " %04x : %2x              LD D, B                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x51:   printf ( " %04x : %2x              LD D, C                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x52:   printf ( " %04x : %2x              LD D, D                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x53:   printf ( " %04x : %2x              LD D, E                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x54:   printf ( " %04x : %2x              LD D, H                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x55:   printf ( " %04x : %2x              LD D, L                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x56:   printf ( " %04x : %2x              LD D, (HL)                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x57:   printf ( " %04x : %2x              LD D, A                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x58:   printf ( " %04x : %2x              LD E, B                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x59:   printf ( " %04x : %2x              LD E, C                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x5A:   printf ( " %04x : %2x              LD E, D                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x5B:   printf ( " %04x : %2x              LD E, E                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x5C:   printf ( " %04x : %2x              LD E, H                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x5D:   printf ( " %04x : %2x              LD E, L                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x5E:   printf ( " %04x : %2x              LD E, (HL)                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x5F:   printf ( " %04x : %2x              LD E, A                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;

        case 0x60:   printf ( " %04x : %2x              LD H, B                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x61:   printf ( " %04x : %2x              LD H, C                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x62:   printf ( " %04x : %2x              LD H, D                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x63:   printf ( " %04x : %2x              LD H, E                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x64:   printf ( " %04x : %2x              LD H, H                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x65:   printf ( " %04x : %2x              LD H, L                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x66:   printf ( " %04x : %2x              LD H, (HL)                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x67:   printf ( " %04x : %2x              LD H, A                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x68:   printf ( " %04x : %2x              LD L, B                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x69:   printf ( " %04x : %2x              LD L, C                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x6A:   printf ( " %04x : %2x              LD L, D                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x6B:   printf ( " %04x : %2x              LD L, E                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x6C:   printf ( " %04x : %2x              LD L, H                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x6D:   printf ( " %04x : %2x              LD L, L                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x6E:   printf ( " %04x : %2x              LD L, (HL)                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x6F:   printf ( " %04x : %2x              LD L, A                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;

        case 0x70:   printf ( " %04x : %2x              LD (HL), B                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x71:   printf ( " %04x : %2x              LD (HL), C                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x72:   printf ( " %04x : %2x              LD (HL), D                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x73:   printf ( " %04x : %2x              LD (HL), E                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x74:   printf ( " %04x : %2x              LD (HL), H                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x75:   printf ( " %04x : %2x              LD (HL), L                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x76:   printf ( " %04x : %2x              HALT                      \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x77:   printf ( " %04x : %2x              LD (HL), A                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x78:   printf ( " %04x : %2x              LD A, B                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x79:   printf ( " %04x : %2x              LD A, C                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x7A:   printf ( " %04x : %2x              LD A, D                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x7B:   printf ( " %04x : %2x              LD A, E                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x7C:   printf ( " %04x : %2x              LD A, H                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x7D:   printf ( " %04x : %2x              LD A, L                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x7E:   printf ( " %04x : %2x              LD A, (HL)                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x7F:   printf ( " %04x : %2x              LD A, A                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;

        case 0x80:   printf ( " %04x : %2x              ADD A, B                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x81:   printf ( " %04x : %2x              ADD A, C                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x82:   printf ( " %04x : %2x              ADD A, D                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x83:   printf ( " %04x : %2x              ADD A, E                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x84:   printf ( " %04x : %2x              ADD A, H                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x85:   printf ( " %04x : %2x              ADD A, L                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x86:   printf ( " %04x : %2x              ADD A, (HL)               \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x87:   printf ( " %04x : %2x              ADD A, A                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x88:   printf ( " %04x : %2x              ADC A, B                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x89:   printf ( " %04x : %2x              ADC A, C                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x8A:   printf ( " %04x : %2x              ADC A, D                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x8B:   printf ( " %04x : %2x              ADC A, E                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x8C:   printf ( " %04x : %2x              ADC A, H                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x8D:   printf ( " %04x : %2x              ADC A, L                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x8E:   printf ( " %04x : %2x              ADC A, (HL)               \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x8F:   printf ( " %04x : %2x              ADC A, A                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;

        case 0x90:   printf ( " %04x : %2x              SUB A, B                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x91:   printf ( " %04x : %2x              SUB A, C                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x92:   printf ( " %04x : %2x              SUB A, D                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x93:   printf ( " %04x : %2x              SUB A, E                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x94:   printf ( " %04x : %2x              SUB A, H                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x95:   printf ( " %04x : %2x              SUB A, L                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x96:   printf ( " %04x : %2x              SUB A, (HL)               \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x97:   printf ( " %04x : %2x              SUB A, A                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x98:   printf ( " %04x : %2x              SBC A, B                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x99:   printf ( " %04x : %2x              SBC A, C                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x9A:   printf ( " %04x : %2x              SBC A, D                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x9B:   printf ( " %04x : %2x              SBC A, E                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x9C:   printf ( " %04x : %2x              SBC A, H                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x9D:   printf ( " %04x : %2x              SBC A, L                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x9E:   printf ( " %04x : %2x              SBC A, (HL)               \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0x9F:   printf ( " %04x : %2x              SBC A, A                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;

        case 0xA0:   printf ( " %04x : %2x              AND A, B                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xA1:   printf ( " %04x : %2x              AND A, C                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xA2:   printf ( " %04x : %2x              AND A, D                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xA3:   printf ( " %04x : %2x              AND A, E                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xA4:   printf ( " %04x : %2x              AND A, H                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xA5:   printf ( " %04x : %2x              AND A, L                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xA6:   printf ( " %04x : %2x              AND A, (HL)               \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xA7:   printf ( " %04x : %2x              AND A, A                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xA8:   printf ( " %04x : %2x              XOR A, B                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xA9:   printf ( " %04x : %2x              XOR A, C                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xAA:   printf ( " %04x : %2x              XOR A, D                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xAB:   printf ( " %04x : %2x              XOR A, E                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xAC:   printf ( " %04x : %2x              XOR A, H                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xAD:   printf ( " %04x : %2x              XOR A, L                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xAE:   printf ( " %04x : %2x              XOR A, (HL)               \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xAF:   printf ( " %04x : %2x              XOR A, A                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;

        case 0xB0:   printf ( " %04x : %2x              OR A, B                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xB1:   printf ( " %04x : %2x              OR A, C                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xB2:   printf ( " %04x : %2x              OR A, D                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xB3:   printf ( " %04x : %2x              OR A, E                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xB4:   printf ( " %04x : %2x              OR A, H                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xB5:   printf ( " %04x : %2x              OR A, L                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xB6:   printf ( " %04x : %2x              OR A, (HL)                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xB7:   printf ( " %04x : %2x              OR A, A                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xB8:   printf ( " %04x : %2x              CP A, B                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xB9:   printf ( " %04x : %2x              CP A, C                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xBA:   printf ( " %04x : %2x              CP A, D                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xBB:   printf ( " %04x : %2x              CP A, E                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xBC:   printf ( " %04x : %2x              CP A, H                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xBD:   printf ( " %04x : %2x              CP A, L                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xBE:   printf ( " %04x : %2x              CP A, (HL)                \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xBF:   printf ( " %04x : %2x              CP A, A                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;

        case 0xC0:   printf ( " %04x : %2x              RET NZ                    \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xC1:   printf ( " %04x : %2x              POP BC                    \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xC2:   printf ( " %04x : %2x %2x %2x      JP NZ, 0x%02x%02x         \n", pc, buffer[pc], buffer[pc+1], buffer[pc+2], buffer[pc+1], buffer[pc+2]  ); op_size = 3; break;
        case 0xC3:   printf ( " %04x : %2x %2x %2x      JP 0x%02x%02x             \n", pc, buffer[pc], buffer[pc+1], buffer[pc+2], buffer[pc+1], buffer[pc+2]  ); op_size = 3; break;
        case 0xC4:   printf ( " %04x : %2x %2x %2x      CALL NZ, 0x%02x%02x       \n", pc, buffer[pc], buffer[pc+1], buffer[pc+2], buffer[pc+1], buffer[pc+2]  ); op_size = 3; break;
        case 0xC5:   printf ( " %04x : %2x              PUSH BC                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xC6:   printf ( " %04x : %2x %2x          ADD A, 0x%02x             \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0xC7:   printf ( " %04x : %2x              RST 0x00                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xC8:   printf ( " %04x : %2x              RET Z                     \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xC9:   printf ( " %04x : %2x              RET                       \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xCA:   printf ( " %04x : %2x %2x %2x      JP Z, 0x%02x%02x          \n", pc, buffer[pc], buffer[pc+1], buffer[pc+2], buffer[pc+1], buffer[pc+2]  ); op_size = 3; break;
/*                                                                     case 0xCB:   printf ( " %04x : %2x              -                         \n", pc, buffer[pc]                                                          ); op_size = 0; break;*/
        case 0xCC:   printf ( " %04x : %2x %2x %2x      CALL Z, 0x%02x%02x        \n", pc, buffer[pc], buffer[pc+1], buffer[pc+2], buffer[pc+1], buffer[pc+2]  ); op_size = 3; break;
        case 0xCD:   printf ( " %04x : %2x %2x %2x      CALL 0x%02x%02x           \n", pc, buffer[pc], buffer[pc+1], buffer[pc+2], buffer[pc+1], buffer[pc+2]  ); op_size = 3; break;
        case 0xCE:   printf ( " %04x : %2x %2x          ADC A, 0x%02x             \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0xCF:   printf ( " %04x : %2x              RST 0x08                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;

        case 0xD0:   printf ( " %04x : %2x              RET NC                    \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xD1:   printf ( " %04x : %2x              POP DE                    \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xD2:   printf ( " %04x : %2x %2x %2x      JP NC, 0x%02x%02x         \n", pc, buffer[pc], buffer[pc+1], buffer[pc+2], buffer[pc+1], buffer[pc+2]  ); op_size = 3; break;
        case 0xD3:   printf ( " %04x : %2x              -                         \n", pc, buffer[pc]                                                          ); op_size = 0; break;
        case 0xD4:   printf ( " %04x : %2x %2x %2x      CALL NC, 0x%02x%02x       \n", pc, buffer[pc], buffer[pc+1], buffer[pc+2], buffer[pc+1], buffer[pc+2]  ); op_size = 3; break;
        case 0xD5:   printf ( " %04x : %2x              PUSH DE                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xD6:   printf ( " %04x : %2x %2x          SUB A, 0x%02x             \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0xD7:   printf ( " %04x : %2x              RST 0x10                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xD8:   printf ( " %04x : %2x              RET C                     \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xD9:   printf ( " %04x : %2x              RETI                      \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xDA:   printf ( " %04x : %2x %2x %2x      JP C, 0x%02x%02x          \n", pc, buffer[pc], buffer[pc+1], buffer[pc+2], buffer[pc+1], buffer[pc+2]  ); op_size = 3; break;
        case 0xDB:   printf ( " %04x : %2x              -                         \n", pc, buffer[pc]                                                          ); op_size = 0; break;
        case 0xDC:   printf ( " %04x : %2x %2x %2x      CALL C, 0x%02x%02x        \n", pc, buffer[pc], buffer[pc+1], buffer[pc+2], buffer[pc+1], buffer[pc+2]  ); op_size = 3; break;
        case 0xDD:   printf ( " %04x : %2x              -                         \n", pc, buffer[pc]                                                          ); op_size = 0; break;
        case 0xDE:   printf ( " %04x : %2x %2x          SBC A, 0x%02x             \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0xDF:   printf ( " %04x : %2x              RST 0x18                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;

        case 0xE0:   printf ( " %04x : %2x %2x          LD (0xFF00 + 0x%02x), A   \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0xE1:   printf ( " %04x : %2x              POP HL                    \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xE2:   printf ( " %04x : %2x              LD (C), A                 \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xE3:   printf ( " %04x : %2x              -                         \n", pc, buffer[pc]                                                          ); op_size = 0; break;
        case 0xE4:   printf ( " %04x : %2x              -                         \n", pc, buffer[pc]                                                          ); op_size = 0; break;
        case 0xE5:   printf ( " %04x : %2x              PUSH HL                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xE6:   printf ( " %04x : %2x %2x          AND A, 0x%02x             \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0xE7:   printf ( " %04x : %2x              RST 0x20                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xE8:   printf ( " %04x : %2x %2x          ADD SP, %02x              \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0xE9:   printf ( " %04x : %2x              JP HL                     \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xEA:   printf ( " %04x : %2x %2x %2x      LD (0x%02x%02x), A        \n", pc, buffer[pc], buffer[pc+1], buffer[pc+2], buffer[pc+1], buffer[pc+2]  ); op_size = 3; break;
        case 0xEB:   printf ( " %04x : %2x              -                         \n", pc, buffer[pc]                                                          ); op_size = 0; break;
        case 0xEC:   printf ( " %04x : %2x              -                         \n", pc, buffer[pc]                                                          ); op_size = 0; break;
        case 0xED:   printf ( " %04x : %2x              -                         \n", pc, buffer[pc]                                                          ); op_size = 0; break;
        case 0xEE:   printf ( " %04x : %2x %2x          XOR A, 0x%02x             \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0xEF:   printf ( " %04x : %2x              RST 0x28                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;

        case 0xF0:   printf ( " %04x : %2x %2x          LD A, (0xFF00 + 0x%02x)   \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0xF1:   printf ( " %04x : %2x              POP AF                    \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xF2:   printf ( " %04x : %2x              LD A, (C)                 \n", pc, buffer[pc]                                                          ); op_size = 3; break;
        case 0xF3:   printf ( " %04x : %2x              DI                        \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xF4:   printf ( " %04x : %2x              -                         \n", pc, buffer[pc]                                                          ); op_size = 0; break;
        case 0xF5:   printf ( " %04x : %2x              PUSH AF                   \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xF6:   printf ( " %04x : %2x %2x          OR A, 0x%02x              \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0xF7:   printf ( " %04x : %2x              RST 0x30                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xF8:   printf ( " %04x : %2x %2x          LD HL, SP + 0x%02x        \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0xF9:   printf ( " %04x : %2x              LD SP, HL                 \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xFA:   printf ( " %04x : %2x %2x %2x      LD A, (0x%02x%02x)        \n", pc, buffer[pc], buffer[pc+1], buffer[pc+2], buffer[pc+1], buffer[pc+2]  ); op_size = 3; break;
        case 0xFB:   printf ( " %04x : %2x              EI                        \n", pc, buffer[pc]                                                          ); op_size = 1; break;
        case 0xFC:   printf ( " %04x : %2x              -                         \n", pc, buffer[pc]                                                          ); op_size = 0; break;
        case 0xFD:   printf ( " %04x : %2x              -                         \n", pc, buffer[pc]                                                          ); op_size = 0; break;
        case 0xFE:   printf ( " %04x : %2x %2x          CP A, 0x%02x              \n", pc, buffer[pc], buffer[pc+1], buffer[pc+1]                              ); op_size = 2; break;
        case 0xFF:   printf ( " %04x : %2x              RST 0x38                  \n", pc, buffer[pc]                                                          ); op_size = 1; break;

        case 0xCB:
            switch ( buffer[pc+1] ) {
                case 0x00: printf ( " %04x : %2x %2x          RLC B                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x01: printf ( " %04x : %2x %2x          RLC C                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x02: printf ( " %04x : %2x %2x          RLC D                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x03: printf ( " %04x : %2x %2x          RLC E                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x04: printf ( " %04x : %2x %2x          RLC H                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x05: printf ( " %04x : %2x %2x          RLC L                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x06: printf ( " %04x : %2x %2x          RLC (HL)                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x07: printf ( " %04x : %2x %2x          RLC A                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x08: printf ( " %04x : %2x %2x          RRC B                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x09: printf ( " %04x : %2x %2x          RRC C                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x0A: printf ( " %04x : %2x %2x          RRC D                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x0B: printf ( " %04x : %2x %2x          RRC E                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x0C: printf ( " %04x : %2x %2x          RRC H                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x0D: printf ( " %04x : %2x %2x          RRC L                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x0E: printf ( " %04x : %2x %2x          RRC (HL)                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x0F: printf ( " %04x : %2x %2x          RRC A                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;

                case 0x10: printf ( " %04x : %2x %2x          RL B                      \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x11: printf ( " %04x : %2x %2x          RL C                      \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x12: printf ( " %04x : %2x %2x          RL D                      \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x13: printf ( " %04x : %2x %2x          RL E                      \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x14: printf ( " %04x : %2x %2x          RL H                      \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x15: printf ( " %04x : %2x %2x          RL L                      \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x16: printf ( " %04x : %2x %2x          RL (HL)                   \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x17: printf ( " %04x : %2x %2x          RL A                      \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x18: printf ( " %04x : %2x %2x          RR B                      \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x19: printf ( " %04x : %2x %2x          RR C                      \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x1A: printf ( " %04x : %2x %2x          RR D                      \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x1B: printf ( " %04x : %2x %2x          RR E                      \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x1C: printf ( " %04x : %2x %2x          RR H                      \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x1D: printf ( " %04x : %2x %2x          RR L                      \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x1E: printf ( " %04x : %2x %2x          RR (HL)                   \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x1F: printf ( " %04x : %2x %2x          RR A                      \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;

                case 0x20: printf ( " %04x : %2x %2x          SLA B                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x21: printf ( " %04x : %2x %2x          SLA C                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x22: printf ( " %04x : %2x %2x          SLA D                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x23: printf ( " %04x : %2x %2x          SLA E                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x24: printf ( " %04x : %2x %2x          SLA H                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x25: printf ( " %04x : %2x %2x          SLA L                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x26: printf ( " %04x : %2x %2x          SLA (HL)                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x27: printf ( " %04x : %2x %2x          SLA A                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x28: printf ( " %04x : %2x %2x          SRA B                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x29: printf ( " %04x : %2x %2x          SRA C                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x2A: printf ( " %04x : %2x %2x          SRA D                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x2B: printf ( " %04x : %2x %2x          SRA E                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x2C: printf ( " %04x : %2x %2x          SRA H                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x2D: printf ( " %04x : %2x %2x          SRA L                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x2E: printf ( " %04x : %2x %2x          SRA (HL)                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x2F: printf ( " %04x : %2x %2x          SRA A                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;

                case 0x30: printf ( " %04x : %2x %2x          SWAP B                    \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x31: printf ( " %04x : %2x %2x          SWAP C                    \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x32: printf ( " %04x : %2x %2x          SWAP D                    \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x33: printf ( " %04x : %2x %2x          SWAP E                    \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x34: printf ( " %04x : %2x %2x          SWAP H                    \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x35: printf ( " %04x : %2x %2x          SWAP L                    \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x36: printf ( " %04x : %2x %2x          SWAP (HL)                 \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x37: printf ( " %04x : %2x %2x          SWAP A                    \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x38: printf ( " %04x : %2x %2x          SRL B                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x39: printf ( " %04x : %2x %2x          SRL C                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x3A: printf ( " %04x : %2x %2x          SRL D                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x3B: printf ( " %04x : %2x %2x          SRL E                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x3C: printf ( " %04x : %2x %2x          SRL H                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x3D: printf ( " %04x : %2x %2x          SRL L                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x3E: printf ( " %04x : %2x %2x          SRL (HL)                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x3F: printf ( " %04x : %2x %2x          SRL A                     \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;

                case 0x40: printf ( " %04x : %2x %2x          BIT 0, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x41: printf ( " %04x : %2x %2x          BIT 0, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x42: printf ( " %04x : %2x %2x          BIT 0, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x43: printf ( " %04x : %2x %2x          BIT 0, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x44: printf ( " %04x : %2x %2x          BIT 0, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x45: printf ( " %04x : %2x %2x          BIT 0, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x46: printf ( " %04x : %2x %2x          BIT 0, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x47: printf ( " %04x : %2x %2x          BIT 0, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x48: printf ( " %04x : %2x %2x          BIT 1, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x49: printf ( " %04x : %2x %2x          BIT 1, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x4A: printf ( " %04x : %2x %2x          BIT 1, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x4B: printf ( " %04x : %2x %2x          BIT 1, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x4C: printf ( " %04x : %2x %2x          BIT 1, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x4D: printf ( " %04x : %2x %2x          BIT 1, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x4E: printf ( " %04x : %2x %2x          BIT 1, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x4F: printf ( " %04x : %2x %2x          BIT 1, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;

                case 0x50: printf ( " %04x : %2x %2x          BIT 2, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x51: printf ( " %04x : %2x %2x          BIT 2, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x52: printf ( " %04x : %2x %2x          BIT 2, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x53: printf ( " %04x : %2x %2x          BIT 2, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x54: printf ( " %04x : %2x %2x          BIT 2, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x55: printf ( " %04x : %2x %2x          BIT 2, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x56: printf ( " %04x : %2x %2x          BIT 2, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x57: printf ( " %04x : %2x %2x          BIT 2, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x58: printf ( " %04x : %2x %2x          BIT 3, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x59: printf ( " %04x : %2x %2x          BIT 3, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x5A: printf ( " %04x : %2x %2x          BIT 3, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x5B: printf ( " %04x : %2x %2x          BIT 3, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x5C: printf ( " %04x : %2x %2x          BIT 3, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x5D: printf ( " %04x : %2x %2x          BIT 3, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x5E: printf ( " %04x : %2x %2x          BIT 3, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x5F: printf ( " %04x : %2x %2x          BIT 3, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;

                case 0x60: printf ( " %04x : %2x %2x          BIT 4, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x61: printf ( " %04x : %2x %2x          BIT 4, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x62: printf ( " %04x : %2x %2x          BIT 4, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x63: printf ( " %04x : %2x %2x          BIT 4, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x64: printf ( " %04x : %2x %2x          BIT 4, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x65: printf ( " %04x : %2x %2x          BIT 4, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x66: printf ( " %04x : %2x %2x          BIT 4, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x67: printf ( " %04x : %2x %2x          BIT 4, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x68: printf ( " %04x : %2x %2x          BIT 5, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x69: printf ( " %04x : %2x %2x          BIT 5, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x6A: printf ( " %04x : %2x %2x          BIT 5, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x6B: printf ( " %04x : %2x %2x          BIT 5, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x6C: printf ( " %04x : %2x %2x          BIT 5, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x6D: printf ( " %04x : %2x %2x          BIT 5, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x6E: printf ( " %04x : %2x %2x          BIT 5, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x6F: printf ( " %04x : %2x %2x          BIT 5, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;

                case 0x70: printf ( " %04x : %2x %2x          BIT 6, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x71: printf ( " %04x : %2x %2x          BIT 6, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x72: printf ( " %04x : %2x %2x          BIT 6, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x73: printf ( " %04x : %2x %2x          BIT 6, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x74: printf ( " %04x : %2x %2x          BIT 6, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x75: printf ( " %04x : %2x %2x          BIT 6, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x76: printf ( " %04x : %2x %2x          BIT 6, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x77: printf ( " %04x : %2x %2x          BIT 6, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x78: printf ( " %04x : %2x %2x          BIT 7, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x79: printf ( " %04x : %2x %2x          BIT 7, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x7A: printf ( " %04x : %2x %2x          BIT 7, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x7B: printf ( " %04x : %2x %2x          BIT 7, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x7C: printf ( " %04x : %2x %2x          BIT 7, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x7D: printf ( " %04x : %2x %2x          BIT 7, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x7E: printf ( " %04x : %2x %2x          BIT 7, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x7F: printf ( " %04x : %2x %2x          BIT 7, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;

                case 0x80: printf ( " %04x : %2x %2x          RES 0, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x81: printf ( " %04x : %2x %2x          RES 0, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x82: printf ( " %04x : %2x %2x          RES 0, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x83: printf ( " %04x : %2x %2x          RES 0, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x84: printf ( " %04x : %2x %2x          RES 0, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x85: printf ( " %04x : %2x %2x          RES 0, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x86: printf ( " %04x : %2x %2x          RES 0, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x87: printf ( " %04x : %2x %2x          RES 0, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x88: printf ( " %04x : %2x %2x          RES 1, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x89: printf ( " %04x : %2x %2x          RES 1, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x8A: printf ( " %04x : %2x %2x          RES 1, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x8B: printf ( " %04x : %2x %2x          RES 1, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x8C: printf ( " %04x : %2x %2x          RES 1, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x8D: printf ( " %04x : %2x %2x          RES 1, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x8E: printf ( " %04x : %2x %2x          RES 1, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x8F: printf ( " %04x : %2x %2x          RES 1, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;

                case 0x90: printf ( " %04x : %2x %2x          RES 2, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x91: printf ( " %04x : %2x %2x          RES 2, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x92: printf ( " %04x : %2x %2x          RES 2, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x93: printf ( " %04x : %2x %2x          RES 2, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x94: printf ( " %04x : %2x %2x          RES 2, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x95: printf ( " %04x : %2x %2x          RES 2, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x96: printf ( " %04x : %2x %2x          RES 2, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x97: printf ( " %04x : %2x %2x          RES 2, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x98: printf ( " %04x : %2x %2x          RES 3, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x99: printf ( " %04x : %2x %2x          RES 3, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x9A: printf ( " %04x : %2x %2x          RES 3, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x9B: printf ( " %04x : %2x %2x          RES 3, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x9C: printf ( " %04x : %2x %2x          RES 3, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x9D: printf ( " %04x : %2x %2x          RES 3, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x9E: printf ( " %04x : %2x %2x          RES 3, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0x9F: printf ( " %04x : %2x %2x          RES 3, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;

                case 0xA0: printf ( " %04x : %2x %2x          RES 4, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xA1: printf ( " %04x : %2x %2x          RES 4, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xA2: printf ( " %04x : %2x %2x          RES 4, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xA3: printf ( " %04x : %2x %2x          RES 4, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xA4: printf ( " %04x : %2x %2x          RES 4, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xA5: printf ( " %04x : %2x %2x          RES 4, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xA6: printf ( " %04x : %2x %2x          RES 4, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xA7: printf ( " %04x : %2x %2x          RES 4, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xA8: printf ( " %04x : %2x %2x          RES 5, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xA9: printf ( " %04x : %2x %2x          RES 5, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xAA: printf ( " %04x : %2x %2x          RES 5, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xAB: printf ( " %04x : %2x %2x          RES 5, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xAC: printf ( " %04x : %2x %2x          RES 5, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xAD: printf ( " %04x : %2x %2x          RES 5, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xAE: printf ( " %04x : %2x %2x          RES 5, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xAF: printf ( " %04x : %2x %2x          RES 5, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;

                case 0xB0: printf ( " %04x : %2x %2x          RES 6, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xB1: printf ( " %04x : %2x %2x          RES 6, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xB2: printf ( " %04x : %2x %2x          RES 6, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xB3: printf ( " %04x : %2x %2x          RES 6, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xB4: printf ( " %04x : %2x %2x          RES 6, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xB5: printf ( " %04x : %2x %2x          RES 6, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xB6: printf ( " %04x : %2x %2x          RES 6, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xB7: printf ( " %04x : %2x %2x          RES 6, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xB8: printf ( " %04x : %2x %2x          RES 7, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xB9: printf ( " %04x : %2x %2x          RES 7, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xBA: printf ( " %04x : %2x %2x          RES 7, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xBB: printf ( " %04x : %2x %2x          RES 7, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xBC: printf ( " %04x : %2x %2x          RES 7, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xBD: printf ( " %04x : %2x %2x          RES 7, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xBE: printf ( " %04x : %2x %2x          RES 7, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xBF: printf ( " %04x : %2x %2x          RES 7, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;

                case 0xC0: printf ( " %04x : %2x %2x          SET 0, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xC1: printf ( " %04x : %2x %2x          SET 0, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xC2: printf ( " %04x : %2x %2x          SET 0, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xC3: printf ( " %04x : %2x %2x          SET 0, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xC4: printf ( " %04x : %2x %2x          SET 0, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xC5: printf ( " %04x : %2x %2x          SET 0, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xC6: printf ( " %04x : %2x %2x          SET 0, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xC7: printf ( " %04x : %2x %2x          SET 0, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xC8: printf ( " %04x : %2x %2x          SET 1, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xC9: printf ( " %04x : %2x %2x          SET 1, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xCA: printf ( " %04x : %2x %2x          SET 1, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xCB: printf ( " %04x : %2x %2x          SET 1, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xCC: printf ( " %04x : %2x %2x          SET 1, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xCD: printf ( " %04x : %2x %2x          SET 1, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xCE: printf ( " %04x : %2x %2x          SET 1, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xCF: printf ( " %04x : %2x %2x          SET 1, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;

                case 0xD0: printf ( " %04x : %2x %2x          SET 2, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xD1: printf ( " %04x : %2x %2x          SET 2, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xD2: printf ( " %04x : %2x %2x          SET 2, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xD3: printf ( " %04x : %2x %2x          SET 2, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xD4: printf ( " %04x : %2x %2x          SET 2, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xD5: printf ( " %04x : %2x %2x          SET 2, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xD6: printf ( " %04x : %2x %2x          SET 2, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xD7: printf ( " %04x : %2x %2x          SET 2, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xD8: printf ( " %04x : %2x %2x          SET 3, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xD9: printf ( " %04x : %2x %2x          SET 3, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xDA: printf ( " %04x : %2x %2x          SET 3, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xDB: printf ( " %04x : %2x %2x          SET 3, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xDC: printf ( " %04x : %2x %2x          SET 3, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xDD: printf ( " %04x : %2x %2x          SET 3, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xDE: printf ( " %04x : %2x %2x          SET 3, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xDF: printf ( " %04x : %2x %2x          SET 3, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;

                case 0xE0: printf ( " %04x : %2x %2x          SET 4, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xE1: printf ( " %04x : %2x %2x          SET 4, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xE2: printf ( " %04x : %2x %2x          SET 4, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xE3: printf ( " %04x : %2x %2x          SET 4, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xE4: printf ( " %04x : %2x %2x          SET 4, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xE5: printf ( " %04x : %2x %2x          SET 4, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xE6: printf ( " %04x : %2x %2x          SET 4, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xE7: printf ( " %04x : %2x %2x          SET 4, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xE8: printf ( " %04x : %2x %2x          SET 5, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xE9: printf ( " %04x : %2x %2x          SET 5, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xEA: printf ( " %04x : %2x %2x          SET 5, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xEB: printf ( " %04x : %2x %2x          SET 5, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xEC: printf ( " %04x : %2x %2x          SET 5, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xED: printf ( " %04x : %2x %2x          SET 5, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xEE: printf ( " %04x : %2x %2x          SET 5, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xEF: printf ( " %04x : %2x %2x          SET 5, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;

                case 0xF0: printf ( " %04x : %2x %2x          SET 6, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xF1: printf ( " %04x : %2x %2x          SET 6, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xF2: printf ( " %04x : %2x %2x          SET 6, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xF3: printf ( " %04x : %2x %2x          SET 6, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xF4: printf ( " %04x : %2x %2x          SET 6, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xF5: printf ( " %04x : %2x %2x          SET 6, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xF6: printf ( " %04x : %2x %2x          SET 6, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xF7: printf ( " %04x : %2x %2x          SET 6, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xF8: printf ( " %04x : %2x %2x          SET 7, B                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xF9: printf ( " %04x : %2x %2x          SET 7, C                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xFA: printf ( " %04x : %2x %2x          SET 7, D                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xFB: printf ( " %04x : %2x %2x          SET 7, E                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xFC: printf ( " %04x : %2x %2x          SET 7, H                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xFD: printf ( " %04x : %2x %2x          SET 7, L                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xFE: printf ( " %04x : %2x %2x          SET 7, (HL)               \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
                case 0xFF: printf ( " %04x : %2x %2x          SET 7, A                  \n", pc, buffer[pc], buffer[pc+1]                                                          ); op_size = 1; break;
            }
            break;

        default:
            printf ( " %04x is not implemented\n " , buffer[pc] );
            break;
    }

    return op_size;
}
